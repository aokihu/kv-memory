## 1. 数据库架构扩展

- [x] 1.1 更新记忆模型 Schema (src/type.ts)，在 MemoryMeta 接口中添加 score 字段
- [x] 1.2 创建数据库迁移脚本，为 memories 表添加 score 列
- [x] 1.3 为 score 列添加 CHECK 约束 (0-100) 和默认值 50
- [x] 1.4 创建索引 idx_memories_score 优化查询性能
- [x] 1.5 更新现有记忆数据，初始化 score = 50
- [x] 1.6 更新 KV 操作逻辑 (src/libs/kv/kv.ts)，支持 score 字段的读写

## 2. 衰退算法核心实现

- [x] 2.1 创建衰退算法模块结构 (src/libs/decay/)
- [x] 2.2 实现得分计算算法核心逻辑
- [x] 2.3 实现时间衰减因子计算
- [x] 2.4 实现使用频率提升计算
- [x] 2.5 实现结构重要性提升计算
- [x] 2.6 实现得分边界检查 (0-100 范围)
- [x] 2.7 添加算法配置管理
- [x] 2.8 实现配置验证和默认值

## 3. 批处理和并发控制

- [x] 3.1 实现记忆分批处理逻辑
- [x] 3.2 添加事务支持确保批处理原子性
- [x] 3.3 实现乐观锁冲突检测
- [x] 3.4 添加重试机制处理冲突
- [x] 3.5 实现批次间延迟控制
- [x] 3.6 添加处理进度跟踪和日志

## 4. 定时任务调度器

- [x] 4.1 创建调度器模块 (src/libs/scheduler/)
- [x] 4.2 实现基于 setInterval 的定时任务
- [x] 4.3 添加调度器启动/停止控制
- [x] 4.4 实现配置化执行间隔 (默认15分钟)
- [x] 4.5 添加调度器状态监控
- [x] 4.6 集成到服务器启动流程 (HTTP/MCP)

## 5. 记忆生命周期管理

- [x] 5.1 实现状态分类逻辑 (active/cold/deprecated)
- [x] 5.2 添加状态阈值配置
- [x] 5.3 实现状态转换检测和记录
- [x] 5.4 添加状态查询工具函数
- [x] 5.5 实现基于状态的记忆过滤
- [x] 5.6 添加状态统计功能

## 6. 查询和过滤功能

- [x] 6.1 扩展记忆查询接口支持 score 范围过滤
- [x] 6.2 添加状态过滤参数支持
- [x] 6.3 实现按得分排序功能
- [x] 6.4 更新搜索服务支持状态过滤
- [x] 6.5 添加记忆统计 API 端点
- [x] 6.6 实现系统健康监控端点

## 7. 配置和监控

- [x] 7.1 创建衰退算法配置文件
- [x] 7.2 实现配置热重载支持
- [x] 7.3 添加算法执行指标收集
- [x] 7.4 实现性能监控和告警
- [x] 7.5 添加详细的操作日志
- [x] 7.6 创建系统健康检查

## 8. 测试和验证

- [x] 8.1 编写衰退算法单元测试
- [x] 8.2 添加调度器集成测试
- [x] 8.3 创建数据库迁移测试
- [x] 8.4 实现并发安全测试
- [x] 8.5 添加性能基准测试
- [x] 8.6 创建端到端功能测试
- [x] 8.7 验证向后兼容性

## 9. 文档和部署

- [x] 9.1 更新 API 文档说明 score 字段
- [x] 9.2 创建配置指南文档
- [x] 9.3 编写运维监控指南
- [x] 9.4 创建故障排除文档
- [x] 9.5 更新部署脚本支持新功能
- [x] 9.6 添加功能开关控制
- [x] 9.7 创建回滚计划文档